# 如何查看空闲IP
- 方法一：  
windows键+R 快捷打开cmd命令行程序，进入命令行提示符状态，在命令行中输入“ping  你想要查看的是否被占用ip地址”回车。如果ping得通，则说明该ip地址对应的计算机已经在线，否则，说明未被占用。什么叫ping的通呢？图示如下：209没有被占用。227被占用了。
![](./ip%E8%A2%AB%E6%9A%82%E7%94%A8%E7%A4%BA%E6%84%8F%E5%9B%BE.png)

- 方法二：  
如果仅仅通过ping方法来判断网络中计算机的存在是不太严谨的，因为防火墙或者过滤规则，会使ping无法返回正确的信息，也就是说，即使上面ping不通，对方也仍然可能会在线。我觉得在这里，你可以用这个配置一下，如果能上网，应该就可以了。说明没有被占用。因为错误率其实也没那么大。那么，我们可以通过ARP缓存解决这个问题。因为防火墙或者过滤包的方法也无法禁止ARP的查看。远程计算机不返回ping成功的消息，但会告诉本地计算机该ip地址对应的MAC地址。这样就可以通过ARP缓存信息来查案了。如果能看到该ip地址对应的MAC地址，说明该计算机在线，相应的，没有出现在ARP缓存表中则表明该计算机不在线。那么具体步骤如何做呢？   
（1）按照前面的ping方法来检测某ip地址的计算机是否在线，如果不通   
（2）在命令提示符中输入“arp -a”来查看本地ARP缓存列表，看对应的ip是否得到了MAC地址信息。  
前面看到。209地址是ping不通的，那我们来验证一下，如图所示：  
![](./arp%20-a%E6%96%B9%E6%B3%95%E6%A3%80%E6%9F%A5%E9%9D%99%E6%80%81%E5%9C%B0%E5%9D%80.png)
未出现209这个ip地址对应的MAC地址，则说明该ip地址未被占用。
未出现209这个ip地址对应的MAC地址，则说明该ip地址未被占用。
- 方法三：批处理法
  利用上述原理，可以通过建立批处理的办法，批量监测局域网中在线的机器。例如，如果要查看网段192.168.64.*中有哪些地址在线，新建一个文本文件，输入下面的代码：   
  FOR /L %%i IN(0，1，255)Do ping 192.168.114./%%i -n 1
  arp -a->IP.txt   
  将该文件保存为.bat文件，双击这个批处理文件将自动搜索网段中的所有IP，并将发现出的ARP信息都保存到ip.txt文件中。其中返回MAC地址的IP所对应的计算机，是在线的。扫描过程中，可用Ctrl+C进行中断。结果如下图所示：
  ![](./%E6%89%B9%E9%87%8Fping%20ip%E7%9A%84%E6%96%B9%E6%B3%95.png) 
  ![](./%E8%BE%93%E5%87%BAip%E7%BB%93%E6%9E%9C.png) 

# 注意
批处理中用%%i,CMD下用%i   
指令  
    for /L %d in（1,1,255） do ping -n 1 192.168.1.%d   
和   
    for /L %d in（1,1,255） do ping.exe -n 1 192.168.1.%d   
都是可以的，但是要用手动输入，不要复制，不然会出现in( 错误不应该出现的字段。如果要保存在文档上，可以在后面加  
for /L %d in（1,1,255） do ping.exe -n 1 192.168.1.%d>>C:\ipaddresses.txt   

这个是将重定向，将结果写进C:\ipaddresses.txt这个文件,或者直接输出>>ip.txt，在用户的文件夹下自动生成该系统。   


# 其他
- ip ping 通与不通 批量保存：   
for /l %D in (1,1,255) do (ping 192.168.1.%D -n 1 && echo 192.168.1.%D>>通.txt || echo 192.168.1.%D >>不通.txt)    
执行完这个命令，就能把ping通的ip和不通的ip分别保存到两个文件里。   
- 如果ping 不通网段的：  
  for /f  %d in (ip.txt) do (ping %d -n 1  && echo %d >>通.txt || echo %d >>不通.txt)   
大家有没有看见多了一个ip.txt文件，这个文件是要你自己准备的哦，把你ping的地址写到这个文件里面，代码会自己读取这个文件里面的ip地址，并且把结果放到两个文件里面去。看见没有多了一个ip.txt文件，这个文件是要你自己准备的哦，把你ping的地址写到这个文件里面，代码会自己读取这个文件里面的ip地址，并且把结果放到两个文件里面去。

# Ping 命令详解

通过点击开始菜单中的“运行”选项，输入“cmd”， 回车即可打开。 输入 ping /? ，可以看到ping 可以使用的参数：  

-t ：Ping 指定的计算机直到中断。

-a ：将地址解析为计算机名。  

-n count ：发送 count 指定的 ECHO 数据包数。默认值为 4。  


-l size ：发送包含由 size 指定的数据量的 ECHO 数据包。默认为 32 字节；最大值是65,527。  

-f ：在数据包中发送”不要分段”标志。数据包就不会被路由上的网关分段。  

-i ttl :将”生存时间”字段设置为 ttl 指定的值。 

-v tos :将”服务类型”字段设置为 tos 指定的值。  

-r count :在”记录路由”字段中记录传出和返回数据包的路由。count 可以指定最少 1 台，最多 9 台计算机。

-s count :指定 count 指定的跃点数的时间戳。 

-j host-list :利用 host-list 指定的计算机列表路由数据包。连续计算机可以被中间网关分隔（路由稀疏源）IP 允许的最大数量为 9。  

-k host-list :利用 host-list 指定的计算机列表路由数据包。连续计算机不能被中间网关分隔（路由严格源）IP 允许的最大数量为 9。  

-w timeout :指定超时间隔，单位为毫秒。  

destination-list :指定要 ping 的远程计算机。   

%i in (1,1,254) ——是遍历主机位从1 ~ 254的所有IP  

-n——ping 的次数  

-w ——timeout时常  

 192.168.0.%i ——遍历IP 自192.168.0.1 ~ 192.168.0.254的所有IP  

| FIND /i  “Reply” ——管道，将前面的结果查找包含“reply”字符行，通过管道输入给后面的命令。  





